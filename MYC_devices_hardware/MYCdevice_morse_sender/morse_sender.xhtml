<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!--This file was converted to xhtml by OpenOffice.org - see http://xml.openoffice.org/odf2xhtml for more info.--><head profile="http://dublincore.org/documents/dcmi-terms/"><meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/><title xml:lang="en-US">DTMF Sender</title><meta name="DCTERMS.title" content="DTMF Sender" xml:lang="en-US"/><meta name="DCTERMS.language" content="en-US" scheme="DCTERMS.RFC4646"/><meta name="DCTERMS.source" content="http://xml.openoffice.org/odf2xhtml"/><meta name="DCTERMS.creator" content="DK1RI"/><meta name="DCTERMS.issued" content="2012-02-01T18:05:06.26" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.contributor" content="DK1RI"/><meta name="DCTERMS.modified" content="2015-12-28T17:23:29.14" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.provenance" content="" xml:lang="en-US"/><meta name="DCTERMS.subject" content="MYC," xml:lang="en-US"/><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" hreflang="en"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" hreflang="en"/><link rel="schema.DCTYPE" href="http://purl.org/dc/dcmitype/" hreflang="en"/><link rel="schema.DCAM" href="http://purl.org/dc/dcam/" hreflang="en"/><style type="text/css">
	@page {  }
	table { border-collapse:collapse; border-spacing:0; empty-cells:show }
	td, th { vertical-align:top; font-size:12pt;}
	h1, h2, h3, h4, h5, h6 { clear:both }
	ol, ul { margin:0; padding:0;}
	li { list-style: none; margin:0; padding:0;}
	<!-- "li span.odfLiEnd" - IE 7 issue-->
	li span. { clear: both; line-height:0; width:0; height:0; margin:0; padding:0; }
	span.footnodeNumber { padding-right:1em; }
	span.annotation_style_by_filter { font-size:95%; font-family:Arial; background-color:#fff000;  margin:0; border:0; padding:0;  }
	* { margin:0;}
	.P1 { font-size:12pt; font-family:Times New Roman; writing-mode:page; text-align:right ! important; }
	.P3 { font-size:14pt; font-family:Times New Roman; writing-mode:page; text-align:center ! important; font-weight:bold; }
	.P4 { font-size:12pt; font-family:Times New Roman; writing-mode:page; font-weight:bold; }
	.P5 { font-size:12pt; font-family:Times New Roman; writing-mode:page; font-weight:normal; }
	.P6 { font-size:12pt; font-family:Times New Roman; writing-mode:page; font-weight:normal; }
	.P7 { font-size:12pt; font-family:Times New Roman; writing-mode:page; font-style:italic; }
	.Standard { font-size:12pt; font-family:Times New Roman; writing-mode:page; }
	.Internet_20_link { color:#000080; text-decoration:underline; }
	.T1 { font-weight:bold; }
	.T2 { color:#0000ff; font-family:Times New Roman; font-size:10pt; text-decoration:underline; }
	.T3 { font-family:Times New Roman; font-size:12pt; }
	<!-- ODF styles with no properties representable as CSS -->
	{ }
	</style></head><body dir="ltr" style="max-width:21.001cm;margin-top:2cm; margin-bottom:2cm; margin-left:2cm; margin-right:2cm; "><p class="P3">Morse Sender</p><p class="P3"> </p><p class="P6">Author DK1RI, Version V01.1, 20151228</p><p class="P6">This project can be found in https://www.github.com/dk1ri</p><p class="P4"> </p><p class="P4">Einleitung</p><p class="Standard"> </p><p class="Standard">Dieses Interface ist eine Vorlage für ein Interface, das ein Gerät, das sich mit Morse Signalen steuern lässt, in ein MYC System einbindet.</p><p class="Standard">Das Interface arbeitet als Slave am I2C Bus  oder kann über RS232 /USB gesteuert werden.</p><p class="Standard"> </p><p class="P4">Beschreibung</p><p class="Standard"> </p><p class="Standard">Es wird die gleiche Leiterplatte wie für das I2C_RS232_Interface verwendet.</p><p class="Standard">Die Eagle Datenstehen unter  [1].</p><p class="Standard">Die Stromversorgung ist 7- 15V, Stromaufnahme ca. 40mA max oder über USB.</p><p class="Standard">Das Programm ist nur das Framework, weitere MYC Befehle des Gerätes müssen nach Bedarf eingefügt werden. Man kann aber Strings direkt entsprechend den MYC Regeln eingeben, die dann in Morsesignale umgesetzt werden.</p><p class="Standard">Es gibt zwei Betriebsarten, der mode bleibt nach dem Ausschalten erhalten:</p><p class="Standard"> </p><p class="P7">MYC_mode, default</p><p class="Standard">Die Befehlsdaten müssen binär eingegeben werden; er erfolgt keine Wandlung, hier im HEX Format:</p><p class="Standard">010448495051</p><p class="Standard">01 ist der Befehl zur Morse  Ausgabe. 04 ist die Länge des nachfolgenden String (in ASCII Format).</p><p class="Standard">Die gesendeten Zeichen werden auch immer über die RS232 Schnittstelle so ausgegeben.</p><p class="Standard"> </p><p class="Standard">Es können 252 Zeichen maximal am Stück übertragen werden; die Länge des Strings wird mit einem Byte übertragen.</p><p class="Standard">Die Tonhöhe ist von 100Hz bis 2kHz einstellbar, die Geschwindigkeit von 5 bis 100 Wpm. Diese Werte sind nicht sehr genau.</p><p class="Standard">Nach Eingabe eines Strings muss man warten, bis die Morse Signale übertragen wurden. Andernfalls gehen Eingabedaten verloren. </p><p class="Standard">RS232 /USB und I2C können „gleichzeitig“ verwendet werden. Allerdings wird beim jedem Wechsel der Befehlspuffer gelöscht.</p><p class="Standard">Es gibt die Möglichkeit, 5er Gruppen mit verschiedenen Zeichensätzen auszugeben: &amp;H06&lt;1 -7&gt;.</p><p class="Standard">Dies kann nur durch Eingabe von &amp;H06 unterbrochen werden.</p><p class="Standard"> </p><p class="P7">Direkt_mode: einschaltbar mit &amp;H08&amp;H01:</p><p class="Standard">Alle erlaubten Morsezeichen, die an der seriellen Schnittstelle in ASCII eingegeben werden,werden  nach Empfang eine LF (Enter) in Morsezeichen umgesetzt.</p><p class="Standard">Eine Rückkehr zu MYC_mode erfolgt mit &amp;H08.</p><p class="Standard">Die I2C Schnittstelle arbeitet immer nur im MYC_mode.</p><p class="Standard"> </p><p class="P4">Befehle</p><p class="Standard"> </p><p class="Standard">Folgende Befehle werden von der I2C / RS232 /USB Schnittstelle akzeptiert:</p><p class="Standard">Befehl <span> </span><span> Parameter</span></p><p class="Standard">'</p><p class="Standard">Announce0:</p><p class="Standard">'Befehl &amp;H00            eigenes basic announcement lesen</p><p class="Standard">'                       basic announcement is read to I2C or output</p><p class="Standard">Data "0;m;DK1RI;morse sender;V01.1;1;170;10;17"</p><p class="Standard">'</p><p class="Standard">Announce1:</p><p class="Standard">'Befehl  &amp;H01 &lt;s&gt;       I2C / RS232 String als Morse senden</p><p class="Standard">'                       send I2C / RS232 String as Morse</p><p class="Standard">Data "1;oa,send morse;252,.\,,:\;,?,-,_,(,) ',=,+,/,@,0 to 10,a to z, A to Z"</p><p class="Standard">'</p><p class="Standard">Announce2:</p><p class="Standard">'Befehl  &amp;H02 0 to 19   Geschwindigkeit schreiben</p><p class="Standard">'                       write speed</p><p class="Standard">Data "2;op,write morse speed;20;5 to 100;5;lin;Wpm"</p><p class="Standard">'</p><p class="Standard">Announce3:</p><p class="Standard">'Befehl  &amp;H03           Geschwindigkeit lesen</p><p class="Standard">'                       read speed</p><p class="Standard">Data "3;ap,as2"</p><p class="Standard">'</p><p class="Standard">Announce4:</p><p class="Standard">'Befehl  &amp;H04 0 to 19   Frequenz schreiben 100 - 2000Hz</p><p class="Standard">'                       write frequency</p><p class="Standard">Data "4;op,write morse frequency;20;100 to 2000;lin;Hz"</p><p class="Standard">'</p><p class="Standard">Announce5:</p><p class="Standard">'Befehl  &amp;H05           Frequenz lesen</p><p class="Standard">'                       read frequency</p><p class="Standard">Data "5;ap,as4"</p><p class="Standard">'</p><p class="Standard">Announce6:</p><p class="Standard">'Befehl  &amp;H06 0 to7     5-er Gruppen Mode einstellen</p><p class="Standard">'                       set mode for groups of 5</p><p class="Standard">Data "6;os,set mode;0,morse input;1,figures;2,a-f;3,g-l;4,m-s;5,t-z;6,special;7,all"</p><p class="Standard">'</p><p class="Standard">Announce7:</p><p class="Standard">'Befehl  &amp;H07           mode lesen</p><p class="Standard">'                       read mode</p><p class="Standard">Data "7;as,as6"</p><p class="Standard">'</p><p class="Standard">Announce8:</p><p class="Standard">'Befehl  &amp;H08 0,1       myc_mode schreiben</p><p class="Standard">'                       write myc_mode</p><p class="Standard">Data "8;os,write myc_mode;0,off;1;on"</p><p class="Standard">'</p><p class="Standard">Announce9:</p><p class="Standard">'Befehl  &amp;H09           myc_mode lesen</p><p class="Standard">'                       read myc_mode</p><p class="Standard">Data "9;as,as8"</p><p class="Standard">'</p><p class="Standard">Announce10:</p><p class="Standard">'Befehl &amp;HF0 :   0-13,</p><p class="Standard">'                253,254 255        announcement aller Befehle in I2C Puffer kopieren</p><p class="Standard">'                                   announcement lines are read to I2C  or output</p><p class="Standard">Data "240;am,ANNOUNCEMENTS;170;17"</p><p class="Standard">'</p><p class="Standard">Announce11:                                                  '</p><p class="Standard">'Befehle &amp;HFC                       Letzten Fehler in I2C Puffer kopieren oder ausgeben</p><p class="Standard">'                                   read last error</p><p class="Standard">Data "252;aa,LAST ERROR;20,last_error"</p><p class="Standard">'</p><p class="Standard">Announce12:                                          '</p><p class="Standard">'Befehl &amp;HFD :                      eigene activ Meldung in I2C Puffer kopieren (&amp;H04) oder ausgeben</p><p class="Standard">'                                   Life signal</p><p class="Standard">Data "253;aa,MYC INFO;b,BUSY"</p><p class="Standard">'</p><p class="Standard">Announce13:</p><p class="Standard">'Befehl &amp;HFE :        *         eigene Individualisierung schreiben</p><p class="Standard">'                               Der Devicename &amp;HFE00 kann maximal 20 Zeichen haben</p><p class="Standard">'                               Anderer Adresstyp &amp;HFE02 kann maximal 3 Zeichen haben.</p><p class="Standard">'                               wird aber ignoriert.</p><p class="Standard">'</p><p class="Standard">Data "254;oa,INDIVIDUALIZATION;20,NAME,Device 1;b,NUMBER,1;1,I2C,1;b,ADRESS,18"</p><p class="Standard">'</p><p class="Standard">Announce14:</p><p class="Standard">'Befehl &amp;HFF :        0 - 3      eigene Individualisierung lesen</p><p class="Standard">Data "255;aa,INDIVIDUALIZATION;20,NAME,Device 1;b,NUMBER,1;1,I2C,1;b,ADRESS,18;1,RS232,1;b,BAUDRATE,0,{19200};3,NUMBER_OF_BITS,8n1;1,USB,1"</p><p class="Standard">'</p><p class="Standard">Announce15:                      'groups of 5 activ</p><p class="Standard">Data "R $7 IF $6 &gt; 0"</p><p class="Standard">'</p><p class="Standard">Announce16:</p><p class="Standard">Data "R !$* IF $6 &gt; 0"</p><p class="Standard"> </p><p class="P4">I2C</p><p class="Standard"> </p><p class="Standard">Die Default Adresse ist 18 (&amp;H12).</p><p class="Standard">Mit dem Befehl &amp;HFE03&lt;n&gt; kann die Adresse in n (1 … 128) geändert werden.</p><p class="Standard">Pullup Widerstände für den I2C Bus (R1/R2) können bei Bedarf bestückt werden. Der Gesamtwiderstand am Bus sollte zwischen 1 und 10 kOhm liegen. </p><p class="P4"> </p><p class="P4">Fehlermeldungen</p><p class="P4"> </p><p class="Standard">Der Befehl &amp;HFC liefert den letzten Fehler im Format:</p><p class="Standard">aktuelle Befehlsnummer - Fehler - Befehlsnummer beim Auftritt des Fehlers</p><p class="Standard">Dazu werden die empfangenen Befehle von 0 bis 255 umlaufend gezählt.</p><p class="Standard"> </p><p class="Standard"> </p><p class="P4">Reset</p><p class="P4"> </p><p class="Standard">Ist der Reset Jumper JP4 beim Anlegen der Versorgungsspannung überbrückt, werden wieder die Defaultwerte eingelesen. Dies ist hilfreich, wenn die aktuelle I2C Adresse verloren gegangen ist.</p><p class="Standard"> </p><p class="P4">Watchdog</p><p class="Standard"> </p><p class="Standard">Die Befehlseingabe muss in weniger als 1 Sekunde beendet sein. Danach werden die bereits empfangenen Daten gelöscht. Dies soll falsche Eingaben vermeiden.  Mit dem "letzten Fehler" Befehl kann man Eingabefehler sehen. Er zeigt die aktuelle Befehlsnummer und die des Fehlers.</p><p class="Standard"> </p><p class="P4">Software</p><p class="P4"> </p><p class="Standard">Die Steuerung übernimmt ein AVR Mikrocontroller Atmega8 oder größer.</p><p class="Standard">Die Software wurde in BASCOM geschrieben [2]</p><p class="Standard"> </p><p class="P4">Programmierung des Prozessors</p><p class="Standard"> </p><p class="Standard">Zur Programmierung des Prozessors ist ein 6poliger ISP Stecker vorhanden.</p><p class="Standard">Um der Prozessor von der Stromversorgung der übrigen Schaltung zu trennen, muss der Jumper JP1 entfernt werden.</p><p class="P6">Die Fuses müssen möglicherweise programmiert werden (sh Bascom Programm) !! Prozessortyp und Frequenz müssen ggf angepasst werden.</p><p class="P4"> </p><p class="P4">RS232 Schnittstelle</p><p class="Standard"> </p><p class="Standard">Schnittstellenparameter: 19k2 8N1</p><p class="Standard">Es muss bei Jumper JP7 und JP8 ist jeweils Pin1 und Pin2  überbrückt werden.</p><p class="Standard">I2C und RS232 / USB können nicht gleichzeitig verwendet. Der Befehlspuffer wird gelöscht, wenn die Schnittstelle gewechselt wird.</p><p class="Standard"> </p><p class="P4">USB Schnittstelle</p><p class="Standard"> </p><p class="Standard">Das Interface kann alternativ mit der USB Platine UM2102 von ELV bestückt werden. Die USB Platine wird plan auf der Oberseite der Interfaces verlötet: der USB Stecker zeigt seitlich nach außen. Die mittleren 4 pins des Verbinders ST2  sind mit dem 4 poligen Verbinder JP9 auf dem Interface zu verbinden.USB Platine und Interface müssen voneinander isoliert werden.</p><p class="Standard">Die Stromversorgung erfolgt dann über USB.</p><p class="Standard"> </p><p class="P4">SMD</p><p class="Standard"> </p><p class="Standard">Die Leiterplatte ist teilweise mit SMD bestückt. Bei den nötigen Bauteilen sind das aber nur  relativ großen Kondensatoren  (1206).</p><p class="P4"> </p><p class="P4">Morse  Ausgang</p><p class="Standard"> </p><p class="Standard">Das Morsesignal kann direkt herausgeführt werden (R7 =0 Ohm, C12 entfällt)  oder über einen Tiefpass (1k/100nF). Das Ausgangssignal ist ein Rechtecksignal und auch nach der Filterung nicht gleichspannungsfrei. Der Pegel im Ruhezustand ist unbestimmt. Ein Koppelkondensator und eine Anpassung des Pegels an den Empfänger wird daher empfohlen.</p><p class="P4">Stromversorgung</p><p class="Standard"> </p><p class="Standard">Die Stromversorgung ist 7- 15V, Stromaufnahme ca. 40mA max. Bei Verwendung des USB Moduls erfolgt die Stromversorgung darüber.</p><p class="P4">Bestückung der Leiterplatte</p><p class="Standard"> </p><p class="Standard">Da die Leiterplatte auch für andere Anwendungen eingesetzt werden kann, brauchen nur folgende Bauteile  bestückt werden:</p><p class="Standard">IC1, Q1, C3 – C6, JP1 (muss für Normalbetrieb überbrückt werden), ohne Tiefpass:R7=0</p><p class="Standard">SL4</p><p class="Standard"> </p><p class="Standard">Verwendung von ISP:</p><p class="Standard">JP6</p><p class="Standard"> </p><p class="Standard">nur mit RS232 Schnittstelle:</p><p class="Standard">IC2, IC3, D1, C1, C2, C7 – C10, JP7, JP8 (jeweils Pin1 und Pin 2 überbrücken), X1, X4 (Buchse)</p><p class="Standard"> </p><p class="Standard">nur mit USB</p><p class="Standard">UM2102</p><p class="Standard"> </p><p class="Standard">nur I2C</p><p class="Standard">R8, R9 nach Bedarf, X2, X3, IC3, D1, C1, C2</p><p class="Standard"> </p><p class="Standard">Weitere Bestückung erleichtert Tests..</p><p class="Standard"> </p><p class="Standard"><span class="T1">Anschlüss</span>e</p><p class="Standard"> </p><p class="Standard">Power</p><p class="Standard">Tip<span> 12V</span></p><p class="Standard">Ring<span> GND</span></p><p class="Standard"> </p><p class="Standard">RS232 (Buchse)</p><p class="Standard">5<span> GND</span></p><p class="Standard">2<span> Jumper</span></p><p class="Standard">3<span> Jumper</span></p><p class="Standard"> </p><p class="Standard">I2C  (2 x 3,5mm Klinke, Stereo)</p><p class="Standard">Sleeve<span> GND</span></p><p class="Standard">Ring<span> SDA</span></p><p class="Standard">Tip<span> SCL</span></p><p class="Standard"> </p><p class="Standard">Morsesignal (LP SL6)</p><p class="Standard">1<span> Morsesignal </span></p><p class="Standard">5<span> GND</span></p><p class="Standard"> </p><p class="P4">Versionen</p><p class="Standard"> </p><p class="Standard">Diese Beschreibung gilt für die</p><p class="Standard">Leiterplattenversion 02.0</p><p class="P6">Bascom Version 01.1</p><p class="P4">Copyright</p><p class="Standard"> </p><p class="P5">Die Ideen in diesem Dokument unterliegen der GPL (Gnu Public Licence V2) soweit keine früheren, anderen Rechte betroffen sind.</p><p class="P5">Die Verwendung der Unterlagen erfolgt auf eigene Geafahr; es wird keinerlei Garantie übernommen.</p><p class="P5">The ideas of this document can be used under GPL (Gnu Public License V2) as long as no earlier other rights are affected.</p><p class="P5">The usage of this document is on own risk, there is no warranty.</p><p class="P5"> </p><p class="P5"> </p><p class="P4">Referenzen</p><p class="Standard"> </p><p class="Standard">[<span class="T3">[1]        </span><a href="http://www.dk1ri.de/common/myc/MYC_i2c_rs232_interface/i2c_rs232_interface_eagle_V01.9.zip" class="Internet_20_link"><span class="T2">i2c_rs232_interface_eagle.zip</span></a></p><p class="Standard">[2]<span> <a href="http://www.dk1ri.de/common/myc/MYC_morse/morse_tx_bascom.zip" class="Internet_20_link">morse_tx_bascom.zip</a></span></p><p class="Standard">[3]<span> <a href="http://www.dk1ri.de/common/myc/MYC_basic/MYC.pdf" class="Internet_20_link">MYC.pdf</a></span></p><p class="Standard"> </p></body></html>