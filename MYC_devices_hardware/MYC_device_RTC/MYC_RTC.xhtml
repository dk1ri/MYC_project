<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!--This file was converted to xhtml by OpenOffice.org - see http://xml.openoffice.org/odf2xhtml for more info.--><head profile="http://dublincore.org/documents/dcmi-terms/"><meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/><title xml:lang="en-US">DTMF Sender</title><meta name="DCTERMS.title" content="DTMF Sender" xml:lang="en-US"/><meta name="DCTERMS.language" content="en-US" scheme="DCTERMS.RFC4646"/><meta name="DCTERMS.source" content="http://xml.openoffice.org/odf2xhtml"/><meta name="DCTERMS.creator" content="DK1RI"/><meta name="DCTERMS.issued" content="2012-02-01T18:05:06.26" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.contributor" content="DK1RI"/><meta name="DCTERMS.modified" content="2016-01-04T09:42:04.72" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.provenance" content="" xml:lang="en-US"/><meta name="DCTERMS.subject" content="MYC," xml:lang="en-US"/><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" hreflang="en"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" hreflang="en"/><link rel="schema.DCTYPE" href="http://purl.org/dc/dcmitype/" hreflang="en"/><link rel="schema.DCAM" href="http://purl.org/dc/dcam/" hreflang="en"/><style type="text/css">
	@page {  }
	table { border-collapse:collapse; border-spacing:0; empty-cells:show }
	td, th { vertical-align:top; font-size:12pt;}
	h1, h2, h3, h4, h5, h6 { clear:both }
	ol, ul { margin:0; padding:0;}
	li { list-style: none; margin:0; padding:0;}
	<!-- "li span.odfLiEnd" - IE 7 issue-->
	li span. { clear: both; line-height:0; width:0; height:0; margin:0; padding:0; }
	span.footnodeNumber { padding-right:1em; }
	span.annotation_style_by_filter { font-size:95%; font-family:Arial; background-color:#fff000;  margin:0; border:0; padding:0;  }
	* { margin:0;}
	.P1 { font-size:12pt; font-family:Times New Roman; writing-mode:page; text-align:right ! important; }
	.P3 { font-size:14pt; font-family:Times New Roman; writing-mode:page; text-align:center ! important; font-weight:bold; }
	.P4 { font-size:12pt; font-family:Times New Roman; writing-mode:page; font-weight:bold; }
	.P5 { font-size:12pt; font-family:Times New Roman; writing-mode:page; font-weight:normal; }
	.P6 { font-size:12pt; font-family:Times New Roman; writing-mode:page; font-weight:normal; }
	.Standard { font-size:12pt; font-family:Times New Roman; writing-mode:page; }
	.Internet_20_link { color:#000080; text-decoration:underline; }
	.T1 { font-weight:bold; }
	.T2 { color:#0000ff; font-family:Times New Roman; font-size:10pt; text-decoration:underline; }
	.T3 { font-family:Times New Roman; font-size:12pt; }
	<!-- ODF styles with no properties representable as CSS -->
	{ }
	</style></head><body dir="ltr" style="max-width:21.001cm;margin-top:2cm; margin-bottom:2cm; margin-left:2cm; margin-right:2cm; "><p class="P3">Realtime Clock mit DCF</p><p class="P3"> </p><p class="P5">Author DK1RI, Version V01.0, 20160103</p><p class="P5">This project can be found in https://www.github.com/dk1ri</p><p class="P4"> </p><p class="P4">Einleitung</p><p class="Standard"> </p><p class="Standard">Dieses Interface ist bindet das RTC DCF  Modul von ELV in das MYC System ein.</p><p class="Standard">Das Interface arbeitet als Slave am I2C Bus</p><p class="Standard"> </p><p class="P4">Beschreibung</p><p class="Standard"> </p><p class="Standard">Die Eagle Daten der Leiterplatte stehen unter  [1].</p><p class="Standard">Als Realtime modul wird der RTC-DCF von ELV verwendet.</p><p class="Standard">Die Stromversorgung ist 7- 15V, Stromaufnahme ca. 40mA mA.</p><p class="Standard">Das Modul wird als Arduino Shield verwendet, dadurch wird die Leiterplatte zwar etwas größer, aber so entfällt die Pegelwandlung.</p><p class="Standard">Die Kommunikation mit dem Modul erfolgt in der jetzigen Version über die UART Schnittstelle. Der Schalter des Moduls muss daher aus 00xxx110 (S1 – S8) eingestellt werden.</p><p class="Standard">Eine spätere Version der Firmware wird SPI verwenden; als MYC Schnittstelle kann dann auch das UART (USB) verwendet werden.</p><p class="Standard">Die MYC Befehle müssen binär eingegeben werden.</p><p class="Standard">Die Uhrzeit kann immer vom I2C Master gelesen werden solange kein anderer Befehl geschickt wurde. Während dieser Zeit blinkt die LED. Nach einem anderen Befehl muss zumindest einmal der Zeit-Lesebefehl (&amp;H01) gesendet werden. </p><p class="Standard">Nach den Befehlen muss mindestens 20ms gewartet werden, damit die Daten vom RTC Modul übertragen werden können.</p><p class="Standard"> </p><p class="P4">Befehle</p><p class="Standard"> </p><p class="Standard">Folgende Befehle werden akzeptiert: </p><p class="Standard">'</p><p class="Standard">Announce0:</p><p class="Standard">'Befehl &amp;H00            eigenes basic announcement lesen</p><p class="Standard">'                       basic announcement is read to I2C or output</p><p class="Standard">Data "0;m;DK1RI;RTC;V01.0;1;160;5;10"</p><p class="Standard">'</p><p class="Standard">Announce1:</p><p class="Standard">'Befehl  &amp;H01           liest Uhrzeit</p><p class="Standard">'                       read time</p><p class="Standard">Data "1;aa,read time;t"</p><p class="Standard">'</p><p class="Standard">Announce2:</p><p class="Standard">'Befehl  &amp;H02           liest Zeit</p><p class="Standard">'                       read time</p><p class="Standard">Data "2;af,read time;7"</p><p class="Standard">'</p><p class="Standard">Announce3:</p><p class="Standard">'Befehl  &amp;H03           liest register</p><p class="Standard">'                       read register</p><p class="Standard">Data "3;aa,read register;b,{x00 to x0E}"</p><p class="Standard">Announce4:</p><p class="Standard">'Befehl  &amp;H04           schreibt register</p><p class="Standard">'                       write register</p><p class="Standard">Data "4;oa,write register;b,{x00 to x0E}"</p><p class="Standard">'</p><p class="Standard">Announce5:</p><p class="Standard">'Befehl &amp;HF0 :   0-13,</p><p class="Standard">'                253,254 255        announcement aller Befehle in I2C Puffer kopieren</p><p class="Standard">'                                   announcement lines are read to I2C  or output</p><p class="Standard">Data "240;am,ANNOUNCEMENTS;160;10"</p><p class="Standard">'</p><p class="Standard">Announce6:                                                  '</p><p class="Standard">'Befehle &amp;HF0                       Letzten Fehler in I2C Puffer kopieren oder ausgeben</p><p class="Standard">'                                   read last error</p><p class="Standard">Data "252;aa,LAST ERROR;20,last_error"</p><p class="Standard">'</p><p class="Standard">Announce7:                                                  '</p><p class="Standard">'Befehl &amp;HFD :                      eigene activ Meldung in I2C Puffer kopieren (&amp;H04) oder ausgeben</p><p class="Standard">'                                   Life signal</p><p class="Standard">Data "253;aa,MYC INFO;b,BUSY"</p><p class="Standard">'</p><p class="Standard">Announce8:</p><p class="Standard">'Befehl &amp;HFE :        *         eigene Individualisierung schreiben</p><p class="Standard">'                               Der Devicename &amp;HFE00 kann maximal 20 Zeichen haben</p><p class="Standard">'</p><p class="Standard">Data "254;oa,INDIVIDUALIZATION;20,NAME,Device 1;b,NUMBER,1;1,I2C,1;b,ADRESS,19"</p><p class="Standard">'</p><p class="Standard">Announce9:</p><p class="Standard">'Befehl &amp;HFF :        0 - 3         eigene Individualisierung lesen</p><p class="Standard">Data "255;aa,as254"</p><p class="Standard">'</p><p class="Standard"> </p><p class="P4">I2C</p><p class="Standard"> </p><p class="Standard">Die Default Adresse ist 19 (&amp;H13)</p><p class="Standard">Mit dem Befehl &amp;HFE03&lt;n&gt; kann die Adresse in n (1 … 128) geändert werden.</p><p class="Standard">Pullup Widerstände für den I2C Bus (R8/R9) können bei Bedarf bestückt werden. Der Gesamtwiderstand am Bus sollte zwischen 1 und 10 kOhm liegen. </p><p class="Standard"> </p><p class="Standard"> </p><p class="P4">Fehlermeldungen</p><p class="P4"> </p><p class="Standard">Der Befehl &amp;HFC liefert den letzten Fehler im Format:</p><p class="Standard">aktuelle Befehlsnummer - Fehler - Befehlsnummer beim Auftritt des Fehlers</p><p class="Standard">Dazu werden die empfangenen Befehle von 0 bis 255 umlaufend gezählt.</p><p class="Standard"> </p><p class="P4">Reset</p><p class="P4"> </p><p class="Standard">Ist der Reset Jumper JP4 beim Anlegen der Versorgungsspannung überbrückt, werden wieder die Defaultwerte eingelesen. Dies ist hilfreich, wenn die aktuelle I2C Adresse verloren gegangen ist.</p><p class="Standard"> </p><p class="P4">Watchdog</p><p class="Standard"> </p><p class="Standard">Die Befehlseingabe muss in weniger als 1 Sekunde beendet sein. Danach werden die bereits empfangenen Daten gelöscht. Dies soll falsche Eingaben vermeiden.  Mit dem "letzten Fehler" Befehl kann man Eingabefehler sehen. Er zeigt die aktuelle Befehlsnummer und die des Fehlers.</p><p class="Standard"> </p><p class="P4">Software</p><p class="P4"> </p><p class="Standard">Die Steuerung übernimmt ein AVR Mikrocontroller Atmega8</p><p class="Standard">Die Software wurde in BASCOM geschrieben [2]</p><p class="Standard"> </p><p class="P4">Programmierung des Prozessors</p><p class="Standard"> </p><p class="Standard">Zur Programmierung des Prozessors ist ein 6poliger ISP Stecker vorgesehen.</p><p class="Standard">Um der Prozessor von der Stromversorgung der übrigen Schaltung zu trennen, muss der Jumper JP1 entfernt werden.</p><p class="P5">Die Fuses müssen möglicherweise programmiert werden (sh Bascom Programm) !! Prozessortyp und Frequenz müssen ggf angepasst werden.</p><p class="P5"> </p><p class="P4">USB Schnittstelle</p><p class="Standard"> </p><p class="Standard">Bei der bisherigen Softwareversion darf der USB Modul nicht bestückt werden.</p><p class="P4"> </p><p class="P4">SMD</p><p class="Standard"> </p><p class="Standard">Die Leiterplatte ist teilweise mit SMD bestückt. Bei den nötigen Bauteilen sind das aber nur relativ große Bauteile. Die SMD LED ist optional.</p><p class="Standard"> </p><p class="P4">Stromversorgung</p><p class="Standard"> </p><p class="Standard">Die Stromversorgung ist 7- 15V, Stromaufnahme ca. 40mA max. </p><p class="Standard"> </p><p class="P4">Bestückung der Leiterplatte</p><p class="Standard"> </p><p class="Standard">Die Buchsen ST1 – ST4 nehmen das RTC Modul auf und sollten daher passende Höhe haben.</p><p class="Standard">Der Prozessor sollte ohne Sockel eingebaut werden.</p><p class="Standard"> </p><p class="Standard">JP5 ist nur bei Verwendung von ISP nötig</p><p class="Standard"> </p><p class="Standard">R1, LED, JP2  erleichtert Tests.</p><p class="Standard"> </p><p class="Standard">Bei Montage der Antenne in der Originalposition ist möglicherweise kein Empfang des DCF77 Signals möglich (Die rote LED des RTC boards muss nach einiger Zeit leuchten). Die Befestigung in einiger Entfernung hilft.</p><p class="Standard">Auf dem RTC board müssen die geeigneten Lötbrücken (für RS232) überbrückt werden.</p><p class="Standard"> </p><p class="Standard"><span class="T1">Anschlüss</span>e</p><p class="Standard"> </p><p class="Standard">Power</p><p class="Standard">Tip<span> 12V</span></p><p class="Standard">Ring<span> GND</span></p><p class="Standard"> </p><p class="Standard">I2C Stereo (2 x 3,5mm Klinke)</p><p class="Standard">Sleeve<span> GND</span></p><p class="Standard">Ring<span> SDA</span></p><p class="Standard">Tip<span> SCL</span></p><p class="Standard"> </p><p class="P4">Versionen</p><p class="Standard"> </p><p class="Standard">Diese Beschreibung gilt für die</p><p class="Standard">Leiterplattenversion 01.0</p><p class="P5">Bascom Version 01.0</p><p class="P4"> </p><p class="P4">Copyright</p><p class="Standard"> </p><p class="P6">Die Ideen in diesem Dokument unterliegen der GPL (Gnu Public Licence V2) soweit keine früheren, anderen Rechte betroffen sind.</p><p class="P6">Die Verwendung der Unterlagen erfolgt auf eigene Geafahr; es wird keinerlei Garantie übernommen.</p><p class="P6">The ideas of this document can be used under GPL (Gnu Public License V2) as long as no earlier other rights are affected.</p><p class="P6">The usage of this document is on own risk, there is no warranty.</p><p class="P6"> </p><p class="P6"> </p><p class="P4">Referenzen</p><p class="Standard"> </p><p class="Standard">[<span class="T3">[1]        </span><a href="http://www.dk1ri.de/common/myc/MYC_rtc/MYC_rtc_eagle.zip" class="Internet_20_link"><span class="T2">rtc_eagle.zip</span></a></p><p class="Standard">[2]<span> <a href="http://www.dk1ri.de/common/myc/MYC_rtc/MYC_rtc_bascom.zip" class="Internet_20_link">rtc_bascom.zip</a></span></p><p class="Standard">[3]<span> <a href="http://www.dk1ri.de/common/myc/MYC_basic/MYC.pdf" class="Internet_20_link">MYC.pdf</a></span></p><p class="Standard"> </p></body></html>