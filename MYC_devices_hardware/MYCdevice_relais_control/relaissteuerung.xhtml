<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!--This file was converted to xhtml by OpenOffice.org - see http://xml.openoffice.org/odf2xhtml for more info.--><head profile="http://dublincore.org/documents/dcmi-terms/"><meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/><title xml:lang="en-US">Realaissteuerung</title><meta name="DCTERMS.title" content="Realaissteuerung" xml:lang="en-US"/><meta name="DCTERMS.language" content="en-US" scheme="DCTERMS.RFC4646"/><meta name="DCTERMS.source" content="http://xml.openoffice.org/odf2xhtml"/><meta name="DCTERMS.creator" content="DK1RI"/><meta name="DCTERMS.issued" content="2012-02-01T17:56:06.17" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.contributor" content="DK1RI"/><meta name="DCTERMS.modified" content="2015-12-28T12:53:14.10" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.provenance" content="" xml:lang="en-US"/><meta name="DCTERMS.subject" content="MYC," xml:lang="en-US"/><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" hreflang="en"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" hreflang="en"/><link rel="schema.DCTYPE" href="http://purl.org/dc/dcmitype/" hreflang="en"/><link rel="schema.DCAM" href="http://purl.org/dc/dcam/" hreflang="en"/><style type="text/css">
	@page {  }
	table { border-collapse:collapse; border-spacing:0; empty-cells:show }
	td, th { vertical-align:top; font-size:12pt;}
	h1, h2, h3, h4, h5, h6 { clear:both }
	ol, ul { margin:0; padding:0;}
	li { list-style: none; margin:0; padding:0;}
	<!-- "li span.odfLiEnd" - IE 7 issue-->
	li span. { clear: both; line-height:0; width:0; height:0; margin:0; padding:0; }
	span.footnodeNumber { padding-right:1em; }
	span.annotation_style_by_filter { font-size:95%; font-family:Arial; background-color:#fff000;  margin:0; border:0; padding:0;  }
	* { margin:0;}
	.P1 { font-size:12pt; font-family:Times New Roman; writing-mode:page; text-align:right ! important; }
	.P3 { font-size:12pt; font-family:Times New Roman; writing-mode:page; font-weight:bold; }
	.P4 { font-size:12pt; font-family:Times New Roman; writing-mode:page; font-weight:normal; }
	.P5 { font-size:18pt; font-family:Times New Roman; writing-mode:page; text-align:center ! important; font-weight:bold; }
	.P6 { font-size:12pt; font-family:Times New Roman; writing-mode:page; font-weight:normal; }
	.Standard { font-size:12pt; font-family:Times New Roman; writing-mode:page; }
	.Internet_20_link { color:#000080; text-decoration:underline; }
	.T1 { font-weight:bold; }
	<!-- ODF styles with no properties representable as CSS -->
	{ }
	</style></head><body dir="ltr" style="max-width:21.001cm;margin-top:2cm; margin-bottom:2cm; margin-left:2cm; margin-right:2cm; "><p class="P5">Relaissteuerung</p><p class="P3"> </p><p class="P4">Author DK1RI, Version V03.1, 20151228</p><p class="P4">This project can be found in https://www.github.com/dk1ri</p><p class="P3"> </p><p class="P3">Einleitung</p><p class="Standard"> </p><p class="Standard">Die Rechnersteuerung erfolgt über I2C Bus mit MYC Protokoll</p><p class="Standard"> </p><p class="P3">Beschreibung</p><p class="Standard"> </p><p class="Standard">Die Eagledaten stehen bei [1].</p><p class="Standard">Als Stromversorgung (7-12V) werden  maximal 150mA benötigt </p><p class="Standard">Die Steuerung macht ein AVR Mikrocontroller.</p><p class="Standard"> </p><p class="Standard">Diese Leiterplatte hat vier Relais mit je zwei Umschaltkontakten, 7 digitale Eingänge und 4 Eingänge, die sich jeweils analog (1024 Stufen Auflösung) oder digital umschalten lasen.Beim Analogbetrieb liegt die Eingangsspannung zwischen 0  und  5V (nicht isoliert und nicht geschützt mit pullup Widerständen). Der Eingangsspannungsbereich ist auf 0 - 1,1V umschaltbar. Der  Eingangsspannungsbereich gilt für alle Eingänge, da die Referenzspannung umgeschaltet wird.</p><p class="Standard">Der Eingangsspannungsbereich und der analog /digital Mode wird im EERAM gespeichert.</p><p class="Standard">Wenn der analog / digital Mode nach dem Einschalten nicht bekannt ist, sollte er gesetzt werden.</p><p class="Standard"> </p><p class="P3">Befehle</p><p class="P3"> </p><p class="P4">Die Befehle müssen binär eingegeben werden; siehe [3]</p><p class="P4">Folgende Befehle werden erkannt:</p><p class="Standard">'</p><p class="Standard">Announce0:</p><p class="Standard">'Befehl &amp;H00               basic annoumement wird gelesen</p><p class="Standard">'                          basic announcement is read</p><p class="Standard">Data "0;m;DK1RI; 4 Relais Bord;V03.1;1;100;31;44"</p><p class="Standard">'</p><p class="Standard">Announce1:</p><p class="Standard">'Befehl &amp;H01               liest digital Wert INP1</p><p class="Standard">'                          read digital INP1</p><p class="Standard">Data "1,as,INP1;0,0;1,1"</p><p class="Standard">'</p><p class="Standard">Announce2:</p><p class="Standard">'Befehl &amp;H02               liest digital Wert INP2</p><p class="Standard">'                          read digital INP2</p><p class="Standard">Data "2,as,INP2;0,0;1,1"</p><p class="Standard">'</p><p class="Standard">Announce3:</p><p class="Standard">'Befehl &amp;H03               liest digital Wert INP3</p><p class="Standard">'                          read digital INP3</p><p class="Standard">Data "3,as,INP3;0,0;1,1"</p><p class="Standard">'</p><p class="Standard">Announce4:</p><p class="Standard">'Befehl &amp;H04               liest digital Wert INP4</p><p class="Standard">'                          read digital INP4</p><p class="Standard">Data "4,as,INP4;0,0;1,1"</p><p class="Standard">'</p><p class="Standard">Announce5:</p><p class="Standard">'Befehl &amp;H05               liest digital Wert INP5</p><p class="Standard">'                          read digital INP5</p><p class="Standard">Data "5,as,INP5;0,0;1,1"</p><p class="Standard">'</p><p class="Standard">Announce6:</p><p class="Standard">'Befehl &amp;H06               liest digital Wert INP6</p><p class="Standard">'                          read digital INP6</p><p class="Standard">Data "6,as,INP6;0,0;1,1"</p><p class="Standard">'</p><p class="Standard">Announce7:</p><p class="Standard">'Befehl &amp;H07               liest digital Wert INP7</p><p class="Standard">'                          read digital INP7</p><p class="Standard">Data "7,as,INP7;0,0;1,1"</p><p class="Standard">'</p><p class="Standard">Announce8:</p><p class="Standard">'Befehl &amp;H08               schaltet Eingang8 analog oder digita</p><p class="Standard">'                          switch inp8 analog /digital</p><p class="Standard">Data "8,os,INP8;1,analog;0,digital"</p><p class="Standard">'</p><p class="Standard">Announce9:</p><p class="Standard">'Befehl &amp;H09               liest analog Wert INP8</p><p class="Standard">'                          read analog INP8</p><p class="Standard">Data "9,ap,INP8;digit;0;1023"</p><p class="Standard">'</p><p class="Standard">Announce10:</p><p class="Standard">'Befehl &amp;H0A               liest digital Wert INP8</p><p class="Standard">'                          read digital INP8</p><p class="Standard">Data "10,as,INP8;0,0;1,1"</p><p class="Standard">'</p><p class="Standard">Announce11:</p><p class="Standard">'Befehl &amp;H0B               schaltet Eingang9 analog oder digita</p><p class="Standard">'                          switch inp9 analog /digital</p><p class="Standard">Data "11,os,INP9;1,analog;0,digital"</p><p class="Standard">'</p><p class="Standard">Announce12:</p><p class="Standard">'Befehl &amp;H0C               liest analog Wert IN9</p><p class="Standard">'                          read analog INP8</p><p class="Standard">Data "12,ap,INP9;w,0 to 1023;-;lin"</p><p class="Standard">'</p><p class="Standard">Announce13:</p><p class="Standard">'Befehl &amp;H0D               liest digital Wert INP9</p><p class="Standard">'                          read digital INP9</p><p class="Standard">Data "13,as,INP9;0,0;1,1"</p><p class="Standard">'</p><p class="Standard">Announce14:</p><p class="Standard">'Befehl &amp;H0E               schaltet Eingang10 analog oder digita</p><p class="Standard">'                          switch inp10 analog /digital</p><p class="Standard">Data "14,os,INP10;1,analog;0,digital"</p><p class="Standard">'</p><p class="Standard">Announce15:</p><p class="Standard">'Befehl &amp;H0F               liest analog Wert IN10</p><p class="Standard">'                          read analog INP10</p><p class="Standard">Data "15,ap,INP10;;w,0 to 1023;-;lin"</p><p class="Standard">'</p><p class="Standard">Announce16:</p><p class="Standard">'Befehl &amp;H10               liest digital Wert INP10</p><p class="Standard">'                          read digital INP10</p><p class="Standard">Data "16,as,INP10;0,0;1,1"</p><p class="Standard"> </p><p class="Standard">Announce17:</p><p class="Standard">'Befehl &amp;H11               schaltet Eingang11 analog oder digita</p><p class="Standard">'                          switch inp11 analog /digital</p><p class="Standard">Data "17,os,INP11;1,analog;0,digital"</p><p class="Standard">'</p><p class="Standard">Announce18:</p><p class="Standard">'Befehl &amp;H12               liest analog Wert IN11</p><p class="Standard">'                          read analog INP11</p><p class="Standard">Data "18,ap,INP11;;w,0 to 1023;-;lin""</p><p class="Standard">'</p><p class="Standard">Announce19:</p><p class="Standard">'Befehl &amp;H13               liest digital Wert INP13</p><p class="Standard">'                          read digital INP13</p><p class="Standard">Data "19,as,INP11;0,0;1,1"</p><p class="Standard">'</p><p class="Standard">Announce20:</p><p class="Standard">'Befehl &amp;H14               liest digital alle</p><p class="Standard">'                          read digital all</p><p class="Standard">Data"20,am,all;w,0 to 4095"</p><p class="Standard">'</p><p class="Standard">Announce21:</p><p class="Standard">'Befehl &amp;H15               schaltet Relais1</p><p class="Standard">'                          switch relais1</p><p class="Standard">Data "21,os,relais1;0,off;1,on"</p><p class="Standard">'</p><p class="Standard">Announce22:</p><p class="Standard">'Befehl &amp;H16               liest Status Relais1</p><p class="Standard">'                          read state relais1</p><p class="Standard">Data "22,as,as21"</p><p class="Standard">'</p><p class="Standard">Announce23:</p><p class="Standard">'Befehl &amp;H17               schaltet Relais2</p><p class="Standard">'                          switch relais2</p><p class="Standard">Data "23,os,relais2;0,off;1,on"</p><p class="Standard">'</p><p class="Standard">Announce24:</p><p class="Standard">'Befehl &amp;H18               liest Status Relais2</p><p class="Standard">'                          read state relais2</p><p class="Standard">Data "24,as,as23"</p><p class="Standard">'</p><p class="Standard">Announce25:</p><p class="Standard">'Befehl &amp;H19               schaltet Relais3</p><p class="Standard">'                          switch relais3</p><p class="Standard">Data "25,os,relais3;0,off;1,on"</p><p class="Standard">'</p><p class="Standard">Announce26:</p><p class="Standard">'Befehl &amp;H1A               liest Status Relais3</p><p class="Standard">'                          read state relais3</p><p class="Standard">Data "26,as,as25"</p><p class="Standard">'</p><p class="Standard">Announce27:</p><p class="Standard">'Befehl &amp;H1B               schaltet Relais4</p><p class="Standard">'                          switch relais4</p><p class="Standard">Data "27,os, relais4;0,off;1,on"</p><p class="Standard">'</p><p class="Standard">Announce28:</p><p class="Standard">'Befehl &amp;H1C               liest Status Relais4</p><p class="Standard">'                          read state relais4</p><p class="Standard">Data "28,as,as27"</p><p class="Standard">'</p><p class="Standard">Announce29:</p><p class="Standard">'Befehl &amp;HEE               schreibt Referenz default: 0:5V 1: 1.1V</p><p class="Standard">'                          write reference voltage</p><p class="Standard">Data "238;oa;a"</p><p class="Standard">'</p><p class="Standard">Announce30:</p><p class="Standard">'Befehl &amp;HEF               liest Referenz default: 0:5V 1: 1.1V</p><p class="Standard">'                          read reference voltage</p><p class="Standard">Data "239;aa,as238"                                         '</p><p class="Standard">'</p><p class="Standard">Announce31:</p><p class="Standard">'Befehl &amp;HF0 :   0-13,</p><p class="Standard">'                253,254 255        announcement aller Befehle lesen</p><p class="Standard">'                                   read announcement lines</p><p class="Standard">'Data "240;am,ANNOUNCEMENTS;100;44"</p><p class="Standard">'</p><p class="Standard">Announce32:</p><p class="Standard">'Befehl &amp;HFC                  Liest letzen Fehler</p><p class="Standard">'                             read last error</p><p class="Standard">Data "252;aa,LAST ERROR;20,last_error"</p><p class="Standard">'</p><p class="Standard">Announce33:</p><p class="Standard">'Befehl &amp;HFD                  geraet aktiv antwort</p><p class="Standard">'                             Life signal</p><p class="Standard">Data "253;aa,MYC INFO;b,&amp;H04,BUSY"</p><p class="Standard">'</p><p class="Standard">Announce34:</p><p class="Standard">'Befehl &amp;HFE :        *         eigene Individualisierung schreiben</p><p class="Standard">'                               Der Devicename &amp;HFE00 kann maximal 20 Zeichen haben</p><p class="Standard">'                               Anderer Adresstyp &amp;HFE02 kann maximal 3 Zeichen haben.</p><p class="Standard">'                               wird aber ignoriert.</p><p class="Standard">'                                write indivdualization</p><p class="Standard">Data "254;oa,INDIVIDUALIZATION;20,NAME,Device 1;b,NUMBER,1;1,I2C,1;b,ADRESS,4"</p><p class="Standard">'</p><p class="Standard">Announce35:</p><p class="Standard">'Befehl &amp;HFF :        0 - 3         eigene Individualisierung lesen</p><p class="Standard">Data "255;aa,as254"</p><p class="Standard">'</p><p class="Standard">Announce36:</p><p class="Standard">Data "R !$9  IF $8=0"</p><p class="Standard">'</p><p class="Standard">Announce37:</p><p class="Standard">Data "R !$10 IF $8=1"</p><p class="Standard">'</p><p class="Standard">Announce38:</p><p class="Standard">Data "R !12 IF $11=0"</p><p class="Standard">'</p><p class="Standard">Announce39:</p><p class="Standard">Data "R !$13 IF $11=1"</p><p class="Standard">'</p><p class="Standard">Announce40:</p><p class="Standard">Data "R !$15 IF $14=0"</p><p class="Standard">'</p><p class="Standard">Announce41:</p><p class="Standard">Data "R !$16 IF $14=1"</p><p class="Standard">'</p><p class="Standard">Announce42:</p><p class="Standard">Data "R !$18 IF $17=0"</p><p class="Standard">'</p><p class="Standard">Announce43:</p><p class="Standard">Data "R !$19 IF $17=1"</p><p class="Standard"> </p><p class="P3">I2C</p><p class="Standard"> </p><p class="Standard">Die Default Adresse ist 4 .</p><p class="Standard">Mit dem Befehl &amp;HFE03&lt;n&gt; kann die Adresse in n geändert werden.</p><p class="Standard">Pullup Widerstände für den I2C Bus (R1/R2)können bei Bedarf bestückt werden. Der Gesamtwiderstand am Bus sollte zwischen 1 und 10 kOhm liegen. </p><p class="Standard"> </p><p class="P3">Fehlermeldungen</p><p class="Standard">Der Befehl &amp;HFC liefert den letzten Fehler im Format:</p><p class="Standard">aktuelle Befehlsnummer - Fehler - Befehlsnummer beim Auftritt des Fehlers</p><p class="Standard">Dazu werden die empfangenen Befehle von 0 bis 255 umlaufend gezählt.</p><p class="Standard"> </p><p class="Standard"> </p><p class="P3">Reset</p><p class="P3"> </p><p class="Standard">Ist der Reset Jumper JP1 beim Anlegen der Versorgungsspannung überbrückt, werden wieder die Defaultwerte eingelesen. Dies ist hilfreich, wenn die aktuelle I2C Adresse verloren gegangen ist.</p><p class="Standard"> </p><p class="P3">Watchdog</p><p class="Standard"> </p><p class="Standard">Die Befehlseingabe muss in weniger als 1 Sekunde beendet sein. Danach werden die bereits empfangenen Daten gelöscht. Dies soll falsche Eingaben vermeiden.  Mit dem "letzten Fehler" Befehl kann man Eingabefehler sehen. Er zeigt die aktuelle Befehlsnummer und die des Fehlers.</p><p class="Standard"> </p><p class="P3">Software</p><p class="P3"> </p><p class="Standard">Die Steuerung übernimmt ein AVR Mikrocontroller ATMEGA8 oder größer.</p><p class="Standard">Das Interface erfolgt über I2C Bus mit MYC Protokoll. (siehe [3]</p><p class="Standard">Die Software wurde in BASCOM geschrieben [2]</p><p class="Standard"> </p><p class="Standard"><span class="T1">Anschlüss</span>e</p><p class="Standard"> </p><p class="Standard">Ansicht auf die Steckerleiste, von links nach rechts:</p><p class="Standard">X1</p><p class="Standard">12<span> GND</span></p><p class="Standard">11<span> Eingang 1 digital</span></p><p class="Standard">10<span> Eingang 2 digital</span></p><p class="Standard">9<span> Eingang 3 digital</span></p><p class="Standard">8<span> Eingang 4 digital</span></p><p class="Standard">7<span> Eingang 5 digital</span></p><p class="Standard">6<span> Eingang 6 digital</span></p><p class="Standard">5<span> Eingang 7 digital</span></p><p class="Standard">3<span> Eingang 8 analog/digital</span></p><p class="Standard">3<span> Eingang 9 analog/digital</span></p><p class="Standard">2<span> Eingang 10 analog/digital</span></p><p class="Standard">1<span> Eingang 11 analog/digital</span></p><p class="Standard"> </p><p class="Standard">X2</p><p class="Standard">12<span> Relais1 Kontakt 1 aktiv </span></p><p class="Standard">11<span> Relais1 Kontakt 1 Mittelanschluss</span></p><p class="Standard">10<span> Relais1 Kontakt 1 Ruhe</span></p><p class="Standard">9<span> Relais1 Kontakt 2 aktiv </span></p><p class="Standard">8<span> Relais1 Kontakt 2 Mittelanschluss</span></p><p class="Standard">7<span> Relais1 Kontakt 2 Ruhe</span></p><p class="Standard">6<span> Relais2 Kontakt 1 aktiv </span></p><p class="Standard">5<span> Relais2 Kontakt 1 Mittelanschluss</span></p><p class="Standard">4<span> Relais2 Kontakt 1 Ruhe</span></p><p class="Standard">3<span> Relais2 Kontakt 2 aktiv </span></p><p class="Standard">2<span> Relais2 Kontakt 2 Mittelanschluss</span></p><p class="Standard">1<span> Relais2 Kontakt 2 Ruhe</span></p><p class="Standard"> </p><p class="Standard">X2</p><p class="Standard">12<span> Relais3 Kontakt 1  aktiv</span></p><p class="Standard">11<span> Relais3 Kontakt 1 Mittelanschluss</span></p><p class="Standard">10<span> Relais3 Kontakt 1 Ruhe</span></p><p class="Standard">9<span> Relais3 Kontakt 2  aktiv</span></p><p class="Standard">8<span> Relais3 Kontakt 2 Mittelanschluss</span></p><p class="Standard">7<span> Relais3 Kontakt 2 Ruhe</span></p><p class="Standard">6<span> Relais4 Kontakt 1  aktiv</span></p><p class="Standard">5<span> Relais4 Kontakt 1 Mittelanschluss</span></p><p class="Standard">4<span> Relais4 Kontakt 1 Ruhe </span></p><p class="Standard">3<span> Relais4 Kontakt 2  aktiv</span></p><p class="Standard">2<span> Relais4 Kontakt 2 Mittelanschluss</span></p><p class="Standard">1<span> Relais4 Kontakt 2 Ruhe</span></p><p class="Standard"> </p><p class="Standard">SL3</p><p class="Standard">1<span> GND</span></p><p class="Standard">2<span> 8-12V</span></p><p class="Standard">3<span> GND</span></p><p class="Standard">4<span> SCL</span></p><p class="Standard">5<span> SDA</span></p><p class="Standard"> </p><p class="P3">Versionen</p><p class="Standard"> </p><p class="Standard">Diese Beschreibung gilt für die</p><p class="Standard">Leiterplattenversion 01.3</p><p class="P4">Bascom Version 03.1</p><p class="P3"> </p><p class="P3">Copyright</p><p class="Standard"> </p><p class="P6">Die Ideen in diesem Dokument unterliegen der GPL (Gnu Public Licence V2) soweit keine früheren, anderen Rechte betroffen sind.</p><p class="P6">Die Verwendung der Unterlagen erfolgt auf eigene Geafahr; es wird keinerlei Garantie übernommen.</p><p class="P6">The ideas of this document can be used under GPL (Gnu Public License V2) as long as no earlier other rights are affected.</p><p class="P6">The usage of this document is on own risk, there is no warranty.</p><p class="P6"> </p><p class="P3">Referenzen</p><p class="Standard"> </p><p class="Standard">1]<span> <a href="http://www.dk1ri.de/common/myc/MYC_relaissteuerung/MYC_relaissteuerung_eagle.zip" class="Internet_20_link">relaissteuerung_eagle.zip</a></span></p><p class="Standard">[2] <span> <a href="http://www.dk1ri.de/common/myc/MYC_relaissteuerung/MYC_relaissteuerung_bascom.zip" class="Internet_20_link">relaissteuerung_bascom.zip</a></span></p><p class="Standard">[3]<span> <a href="http://www.dk1ri.de/common/myc/MYC_basic/MYC.pdf" class="Internet_20_link">MYC.pdf</a></span></p></body></html>